<html>
<head>
    <title>OPD 40cm telops page</title>
    <link rel="stylesheet" type="text/css" href="telops.css">

    <!-- common variables to all javascript like lat, long -->
    <script language="JavaScript" src="site.js"></script>

    <!-- Load clock javascript -->
    <script language="JavaScript" src="sidereal_clock.js"></script>

    <!-- Load skymap javascript -->
    <script src="jquery-1.9.1.min.js"></script>
    <script src="vs/virtualsky.min.js" type="text/javascript"></script>
    <script>
        $(document).ready(function () {

            var planetarium = $.virtualsky({
                id: 'starmap',
                projection: 'fisheye',
                live: true,
                showgalaxy: true,
                latitude: latitu,
                longitude: longit
            });
            planetarium.addPointer({
                'ra': 0,
                'dec': 0,
                'label': '40cm',
                'colour': 'rgb(255,220,220)'
            });
            telescope_pointer = planetarium.pointers[0]
        });


    </script>

    <!-- Update tables data periodically -->
    <script src="query_data.js" type="text/javascript"></script>

    <!-- Reload images periodically -->
    <script>
        // 	1 - Graphs every minute
        setInterval(function () {
            $("#teltempgraph").attr("src", "/rrd/temperatures.png?" + new Date().getTime());
        }, 60000);
        // 	2 - Allsky images every 10 minutes
        setInterval(function () {
            $("#allsky").attr("src", "http://200.131.64.207/allsky/imagens340/AllSkyCurrentImage.JPG?" + new Date().getTime());
        }, 600000);
        // 	2 - Webcam images every 5 minutes
        setInterval(function () {
            $("#internal-cam").attr("src", "/intcam.jpg?" + new Date().getTime());
        }, 300000);
        // 	2 - Focus every 10 minutes
        setInterval(function () {
            $("#last-focus").attr("src", "/autofocus.png?" + new Date().getTime());
        }, 600000);
        // 	2 - Cloud watcher every 2 minutes
        setInterval(function () {
            $("#cw-cloud").attr("src", "http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageCloudCondition.png?" + new Date().getTime());
        }, 120000);
        setInterval(function () {
            $("#cw-light").attr("src", "http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageDayCondition.png?" + new Date().getTime());
        }, 120000);
        setInterval(function () {
            $("#cw-rain").attr("src", "http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageRainCondition.png?" + new Date().getTime());
        }, 120000);
        setInterval(function () {
            $("#cw-temperature").attr("src", "http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageTemperature.png?" + new Date().getTime());
        }, 120000);

        // 	2 - Weather station every 2 minutes
        setInterval(function () {
            $("#opd-temperature").attr("src", "http://200.131.64.185/clima/Images/Profile1/OutsideTempHistory.gif?" + new Date().getTime());
        }, 120000);
        setInterval(function () {
            $("#opd-humidity").attr("src", "http://200.131.64.185/clima/Images/Profile1/OutsideHumidityHistory.gif?" + new Date().getTime());
        }, 120000);
        setInterval(function () {
            $("#opd-leaf").attr("src", "http://200.131.64.185/clima/Images/Profile1/LeafWet1History.gif?" + new Date().getTime());
        }, 120000);
        setInterval(function () {
            $("#opd-uv").attr("src", "http://200.131.64.185/clima/Images/Profile1/UVHistory.gif?" + new Date().getTime());
        }, 120000);


    </script>

    <!--sun phase script-->
    <script src="suncalc.js" type="text/javascript"></script>


</head>
<body>

<div align="center"><h1>OPD 40cm Telops page</h1></div>
<!--<div align="center"><h3><font color="red">Red</font> means outdated information. <br>All times are UT</h3></div>-->

<div class="telescope">
    <h2>Observatory</h2>
    <table class="telescope-data">
        <tr>


            <td class="maps-graphs">
                <div id="starmap" style="width:400px;height:400px;"></div>
                <!--<iframe width="500" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"-->
                <!--src="http://lcogt.net/virtualsky/embed/?longitude=-70&latitude=-16&projection=polar"-->
                <!--allowTransparency="true"></iframe>-->
                <!--<img id="teltempgraph" src="/rrd/temperatures.png"><br>-->

                <div align="left">
                    <img id="allsky" src="http://200.131.64.207/allsky/imagens340/AllSkyCurrentImage.JPG" , width=500,
                         height=350><br>
                </div>

            </td>

            <td class="data-list">


                <!--CONTROL-->
                <table>
                    <tr>
                        <td class="caution-name">TELESCOPE CONTROL</td>
                    </tr>
                    <tr>
                        <td>
                            <iframe src="control/" style="border:none;"></iframe>
                        </td>
                    </tr>


                </table>
                <!--END OF CONTROL-->

                <!--STATUS-->
                <table>
                    <tr>
                        <td class="caution-name">SUPERVISOR STATUS</td>
                    </tr>

                    <tr>
                        <td class="observatory-prop-name">SITE</td>
                        <td><label id="supervisor_telops_site"></label></td>
                    </tr>
                    <!--<tr>-->
                    <!--<td class="observatory-prop-name">TELESCOPE</td>-->
                    <!--<td><label id="supervisor_telops_telescope"></label></td>-->
                    <!--</tr>-->
                    <tr>
                        <td class="observatory-prop-name">DOME</td>
                        <td><label id="supervisor_telops_dome"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">ROBOBS</td>
                        <td><label id="supervisor_telops_robobs"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Last Update</td>
                        <td><label id="supervisor_telops_last_update"></label></td>
                    </tr>


                </table>
                <!-- END OF STATUS -->


                <hr>

                <table>
                    <!-- begin clock section -->
                    <tr>
                        <td class="observatory-name">TIME</td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">UTC</td>
                        <td><label id="utc_clock"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">LST</td>
                        <td><label id="lst_clock">
                            <script>calculate_clock();</script>
                        </label></td>
                    </tr>


                    <tr>
                        <td class="observatory-name">MOON & SUN</td>
                    </tr>

                    <tr>
                        <td class="observatory-prop-name">Moon Phase</td>
                        <td><label id="moon_phase"></label> %
                        </td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Moon Altitude</td>
                        <td><label id="moon_alt"></label> deg
                        </td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">
                            Next Moon Rise
                        </td>
                        <td>
                            <label id="moon_rise"></label>
                        </td>
                    <tr>
                        <td class="observatory-prop-name">
                            Next Moon Set
                        </td>
                        <td>
                            <label id="moon_set"></label>
                        </td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Sun Altitude</td>
                        <td><label id="sun_alt"></label> deg
                        </td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">
                            Next Dawn
                        </td>
                        <td>
                            <label id="sun_dawn"></label>
                        </td>
                    <tr>
                        <td class="observatory-prop-name">
                            Next Dusk
                        </td>
                        <td>
                            <label id="sun_dusk"></label>
                        </td>
                        <script>

                            document.getElementById('moon_phase').innerHTML = 100 * Math.round(100 * SunCalc.getMoonIllumination(new Date()).fraction) / 100;

                            var moon = SunCalc.getMoonTimes(new Date(), latitu, longit, 1);
                            document.getElementById('moon_rise').innerHTML = ("0" + moon.rise.getUTCHours()).slice(-2) + ":" + ("0" + moon.rise.getUTCMinutes()).slice(-2) + ":" + ("0" + moon.rise.getUTCSeconds()).slice(-2);
                            document.getElementById('moon_set').innerHTML = ("0" + moon.set.getUTCHours()).slice(-2) + ":" + ("0" + moon.set.getUTCMinutes()).slice(-2) + ":" + ("0" + moon.set.getUTCSeconds()).slice(-2);

                            var sun = SunCalc.getTimes(new Date(), latitu, longit, 1);
                            document.getElementById('sun_dawn').innerHTML = ("0" + sun.dawn.getUTCHours()).slice(-2) + ":" + ("0" + sun.dawn.getUTCMinutes()).slice(-2) + ":" + ("0" + sun.dawn.getUTCSeconds()).slice(-2);
                            document.getElementById('sun_dusk').innerHTML = ("0" + sun.dusk.getUTCHours()).slice(-2) + ":" + ("0" + sun.dusk.getUTCMinutes()).slice(-2) + ":" + ("0" + sun.dusk.getUTCSeconds()).slice(-2);

                            var sunpos = SunCalc.getPosition(new Date(), latitu, longit);
                            document.getElementById('sun_alt').innerHTML = Math.round(sunpos.altitude * 180 / Math.PI);

                            var moonpos = SunCalc.getMoonPosition(new Date(), latitu, longit);
                            document.getElementById('moon_alt').innerHTML = Math.round(moonpos.altitude * 180 / Math.PI);


                        </script>
                    </tr>
                    <!-- end clock section -->

                    <!--MOUNT-->
                    <tr>
                        <td class="observatory-name">MOUNT</td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">State</td>
                        <td><label id="telescope_paramount_state"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Position (ra, dec)</td>
                        <td><label id="telescope_paramount_ra"></label><br><label id="telescope_paramount_dec"></label>
                        </td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">M1 Fan</td>
                        <td><label id="fan_M1_state"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Last Update</td>
                        <td><label id="telescope_paramount_last_update"></label></td>
                    </tr>

                    <!--DOME-->
                    <tr>
                        <td class="observatory-name">DOME</td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">State</td>
                        <td><label id="dome_dome40_state"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Dome Slit</td>
                        <td><label id="dome_dome40_slit"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Azimuth</td>
                        <td><label id="dome_dome40_azimuth"></label></td>
                    </tr>
                    <td class="observatory-prop-name">Last Update</td>
                    <td><label id="dome_dome40_last_update"></label></td>
                    </tr>


                    <!--CAMERA-->
                    <tr>
                        <td class="observatory-name">CAMERA</td>
                    </tr>
                    <!--<tr>-->
                    <!--<td class="observatory-prop-name">State</td>-->
                    <!--<td><label id="camera_apogee_state"></label></td>-->
                    <!--</tr>-->

                    <tr>
                        <td class="observatory-prop-name">Temperature</td>
                        <td><label id="camera_apogee_AltaU16M_temperature"></label></td>
                    </tr>

                    <tr>
                        <td class="observatory-prop-name">Last Update</td>
                        <td><label id="camera_apogee_AltaU16M_last_update"></label></td>
                    </tr>

                    <!--SCHEDULERS-->
                    <tr>
                        <td class="observatory-name">SCHEDULER</td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">State</td>
                        <td><label id="scheduler_state_lna40sched_state"></label></td>
                    </tr>

                    <tr>
                        <td class="observatory-prop-name">Last message</td>
                        <td><label id="scheduler_msg_lna40sched_message"></label></td>
                    </tr>

                    <tr>
                        <td class="observatory-prop-name">State Update</td>
                        <td><label id="scheduler_state_lna40sched_last_update"></label></td>
                    </tr>
                    <tr>
                        <td class="observatory-prop-name">Message Update</td>
                        <td><label id="scheduler_msg_lna40sched_last_update"></label></td>
                    </tr>

                </table>
            </td>

        </tr>
    </table>
</div>

<div align="center">
    <h2>Weather</h2>

    <table>
        <!--class="weather-data"-->
        <tr>
            <td class="maps-graphs">

                Dome Cam (<a href="http://200.131.64.169/" , target="_video">Open VIDEO</a>)<br>
                <img id="internal-cam" src="/intcam.jpg" , width=640, height=480><br>

                Last Focus <br>
                <img id="last-focus" src="/autofocus.png"><br>


                <!--TOLOLO<br>-->
                <!--<img id="tascaallsky" src="/tasca/late_r.png" , width=512, height=512><br>-->

                <!--LCOGT<br>-->
                <!--<img id="lcogtallsky" src="http://lcogt.net/camera/data/lsc/allsky/lastsnap.jpg" , width=500,-->
                <!--height=350><br>-->

                <!--<img id="weathergraph" src="http://139.229.20.220/~cacti/graphs/graph_5_5.png"><br>-->
            </td>


            <td class="data-list">
                <table>

                    <!-- 1.60m -->
                    <tr>
                        <td class="weather-name">OPD 1.60m</td>
                    </tr>
                    <tr>
                        <td class="weather-prop-name">Temperature</td>
                        <td><label id="weather_opd160_temperature"></label></td>
                    </tr>
                    <tr>
                        <td class="weather-prop-name">Humidity</td>
                        <td><label id="weather_opd160_humidity"></label></td>
                    </tr>
                    <!--<tr>-->
                    <!--<td class="weather-prop-name">Sky Transparency</td>-->
                    <!--<td><label id="weather_opd160_sky_transparency"></label></td>-->
                    <!--</tr>-->
                    <tr>
                        <td class="weather-prop-name">Wind Speed</td>
                        <td><label id="weather_opd160_wind_speed"></label><br><label
                                id="weather_opd160_wind_direction"></label></td>
                    </tr>

                    <tr>
                        <td class="weather-prop-name">Sky Transparency</td>
                        <td><label id="weather_aag_sky_transparency"></label></td>
                    </tr>

                    <tr>
                        <td class="weather-prop-name">Pressure</td>
                        <td><label id="weather_opd160_pressure"></label></td>
                    </tr>
                    <!--<tr>-->
                    <!--<td class="weather-prop-name">Rain</td>-->
                    <!--<td><label id="weather_opd160_rain"></label></td>-->
                    <!--</tr>-->
                    <tr>
                        <td class="weather-prop-name">Weather Station Last Update</td>
                        <td><label id="weather_opd160_last_update"></label></td>
                    </tr>

                    <tr>
                        <td class="weather-prop-name">Transparency Last Update</td>
                        <td><label id="weather_aag_last_update"></label></td>
                    </tr>

                    <!--Weather Graphs-->
                    <tr>
                        <td class="weather-name">Temperature</td>
                        <td class="weather-name">Humidity</td>
                    </tr>

                    <tr>
                        <td><img id="opd-temperature"
                                 src="http://200.131.64.185/clima/Images/Profile1/OutsideTempHistory.gif"></td>
                        <td><img id="opd-humidity"
                                 src="http://200.131.64.185/clima/Images/Profile1/OutsideHumidityHistory.gif"></td>
                    </tr>

                    <tr>
                        <td class="weather-name">Leaf Wetness</td>
                        <td class="weather-name">UV</td>
                    </tr>

                    <tr>
                        <td><img id="opd-leaf" src="http://200.131.64.185/clima/Images/Profile1/LeafWet1History.gif"></td>
                        <td><img id="opd-uv" src="http://200.131.64.185/clima/Images/Profile1/UVHistory.gif"></td>
                    </tr>
                    <!--Weather Graphs END-->


                    <!--Cloud Watcher-->
                    <!--<table>-->
                    <tr>
                        <td class="weather-name">Cloud sensor CW</td>
                        <td class="weather-name">Luminosity Sensor CW</td>
                    </tr>
                    <tr>
                        <td><img id="cw-cloud"
                                 src="http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageCloudCondition.png"></td>
                        <td><img id="cw-light"
                                 src="http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageDayCondition.png"></td>
                    </tr>
                    <tr>
                        <td class="weather-name">Rain Sensor CW</td>
                        <td class="weather-name">Temperature sensor CW</td>
                    </tr>
                    <tr>
                        <td><img id="cw-rain"
                                 src="http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageRainCondition.png"></td>
                        <td><img id="cw-temperature"
                                 src="http://200.131.64.207/allsky/sensor_nuvens/AAG_ImageTemperature.png"></td>
                    </tr>
                    <!--</table>-->
                    <!--END Cloud Watcher-->

                    <!--Horizontal divider-->

                    </td>

                    </tr>
                </table>
    </table>

</div>

<!--<div align="center">-->
<!--<h2>Lights</h2>-->
<!--<table class="lights-data">-->
<!--<tr>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--</tr>-->
<!--<tr>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--</tr>-->
<!--<tr>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--<td>Camera 1</td>-->
<!--<td>ON</td>-->
<!--</tr>-->
<!--</table>-->
<!--</div>-->

</body>
</html>